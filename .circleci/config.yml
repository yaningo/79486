version: 2.1

orbs:
  win: circleci/windows@2.4.0

jobs:
  build:
    executor:
      name: win/default
      shell: powershell.exe
    steps:
      - run:
          name: Install build tools
          command: |
              Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))

              choco install visualcpp-build-tools --version=15.0.26228.0
              
              
      - store_artifacts:
          path: C:\ProgramData\chocolatey\logs\chocolatey.log
          destination: chocolatey.log
          
      - store_artifacts:
          path: C:\Users\circleci\AppData\Local\Temp\chocolatey\visualcpp-build-tools.log
          destination: visualcpp-build-tools.log
          
          
          

              
      - run:
          name: Check MSBuild version
          #shell: cmd.exe
          command: |
              C:\"Program Files (x86)"\"Microsoft Visual Studio"\2017\BuildTools\Common7\Tools\VsDevCmd.bat -arch=amd64 -host_arch=amd64
              ls "C:\Program Files (x86)\Microsoft Visual Studio\"
              C:\"Program Files (x86)"\"Microsoft Visual Studio"\2017\BuildTools\MSBuild\15.0\Bin\MSBuild.exe -version
              $env:Path += ";C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\MSBuild\15.0\Bin"
              refreshenv
              MSBuild.exe -version
              
